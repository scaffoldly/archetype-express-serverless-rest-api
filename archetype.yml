
---
script:

  - rules:
      - source:
          Junk Files:
            patterns:
              - glob: "*.DS_Store"
            action: SKIP

  - set:
      application-name:
        prompt: "Application Name?"
      repository-name:
        prompt: "Repository Name?"
      service-name:
        prompt: "Service Name?"
      auth-service:
        prompt: "Auth Service Exists?"
        type: bool
      persistence:
        prompt: "Persistence Type? [dynamodb]"
        default: ""
      entities:
        prompt: "Entities?"
        type: list

  - render:
      directory:
        source: "github"

  - render:
      directory:
        source: "express/immutable/serverless"

  - if:
      conditions:
        - switch-enabled: overwrite
      then:
        - rules:
            - destination:
                overwrite: true
        - render:
            directory:
              source: "express/serverless"

  - if:
      is-true: "{{ persistence == 'dynamodb' }}"
      then:
        - for:
            item:
              in: entities
              name: entity
            do:
              - info: "Rendering {{ entity }} entity for DynamoDB"
              - render:
                  directory:
                    source: "express/immutable/dynamodb"
